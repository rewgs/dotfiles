# =============================================================================
# basics
# =============================================================================

# Force tmux to assume that the terminal supports 256 colors
# set -g default-terminal "tmux-256color" 	# this is no longer needed thanks to the following line; keeping it for now though just in case
set -ga terminal-overrides ",*256col*:Tc"

# Removes delay when switching from Insert mode to Normal mode in (n)vim/helix/etc
set -sg escape-time 0 						

# Enable mouse control (clickable windows, panes, resizable panes; applies to tmux version 2.1 and above)
set -g mouse on 							

# Automatically renames windows
set-window-option -g automatic-rename on	

# Makes first tmux window number 1 instead of number 0
set -g base-index 1							

# Automatically renumbers windows if they're closed out of order (e.g. close 1 and 3, only 2 remains, 2 is renumbered to 1 automatically)
set -g renumber-windows on					

# Moves the bar from the bottom to the top
set -g status-position top					

# tmux-powerline (https://github.com/erikw/tmux-powerline)
set-option -g status on
set-option -g status-interval 2
set-option -g status-justify "centre"
set-option -g status-left-length 60
set-option -g status-right-length 90
set-option -g status-left  "#(~/src/tmux-powerline/powerline.sh left)"
set-option -g status-right "#(~/src/tmux-powerline/powerline.sh right)"
set-hook -g session-created 'run-shell "~/src/tmux-powerline/powerline.sh init"' # prettifies the window-status segments


# =============================================================================
# key bindings
# =============================================================================

# -------------------------------------
# Notes:
# -------------------------------------

#   Modifer Keys: 
#   C- = Control
#   S- = Shift
#   M- = Alt ("Meta")

#   Flags:
#   -n = no prefix required
#   -r = repeatable

#   Prefix and the Super/Windows/Command key with iTerm2:
#   - The prefix key is control + p (or, in tmux speak, C-p)
#   - The hex code for C-p is 10
#   - e.g. to send prefix + h:
#       - The iTerm2 key command is Command + h.
#       - This sends the key code 10 68, or control+p h.
#       - Therefore, the Command key is essentially the tmux prefix.

# -------------------------------------
# Unbinding
# -------------------------------------

# alt-arrows and alt-[hjkl] as it's interfering with my editor.
unbind M-Left
unbind M-Right
unbind M-Up
unbind M-Down
unbind M-h
unbind M-l
unbind M-k
unbind M-j

# unbinding other stuff I guess? Not sure why I did this.
unbind h
unbind j
unbind k
unbind l
unbind H
unbind J
unbind K
unbind L
# unbind C-h
# unbind C-j
# unbind C-k
# unbind C-l
# unbind C-H
# unbind C-J
# unbind C-K
# unbind C-L

# -------------------------------------
# global
# -------------------------------------

# prefix
unbind C-p
set -g prefix C-p
bind-key C-p send-prefix

# reload/source config
bind M-r source-file ~/.tmux.conf

# command prompt
# unbind-key :
# unbind-key c
bind-key : command-prompt

# close pane OR window
bind w killp

# -------------------------------------
# panes
# -------------------------------------

# split vertically (i.e. create pane below)
unbind '"'
bind '-' split-window -v -c '#{pane_current_path}'

# split horizontally (i.e. create pane to the right)
unbind % 
bind '\' split-window -h -c '#{pane_current_path}'

# select
bind-key h select-pane -L
bind-key j select-pane -D
bind-key k select-pane -U
bind-key l select-pane -R
# bind-key -n C-h select-pane -L
# bind-key -n C-j select-pane -D
# bind-key -n C-k select-pane -U
# bind-key -n C-l select-pane -R

# resize
bind-key H resize-pane -L 10
bind-key J resize-pane -D 10
bind-key K resize-pane -U 10
bind-key L resize-pane -R 10
# bind-key -n C-H resize-pane -L 10
# bind-key -n C-J resize-pane -D 10
# bind-key -n C-K resize-pane -U 10
# bind-key -n C-L resize-pane -R 10

# swap panes
# clockwise
unbind M-o
bind-key + swap-pane -D
# counter-clockwise
unbind C-o
bind-key _ swap-pane -U


# -------------------------------------
# windows (i.e. 'tabs')
# -------------------------------------

# create new
unbind c
bind-key t new-window 

# select next
bind-key n next-window

# select previous
bind-key p previous-window

# rename window
unbind ,
bind-key r command-prompt -I "#W" "rename-window '%%'"


# -------------------------------------
# SESSIONS
# (I think of these as 'windows')
# -------------------------------------

bind-key s command-prompt -I "#S"

# rename session
unbind &
bind-key R command-prompt -I "#S" "rename-session '%%'"


# =============================================================================
# tmux plugin manager
# =============================================================================

# NOTES:
# - Make sure that this is always the bottom section of this file!
# - Command to install a plugin (after writing config here): prefix + shift+i

set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-sensible'
set -g @plugin 'tmux-plugins/tmux-resurrect'
set -g @plugin 'tmux-plugins/tmux-continuum'

# -------------------------------------
# themes
# -------------------------------------

# onedark
# set -g @plugin 'odedlaz/tmux-onedark-theme'
# run '~/.tmux/plugins/tmux-onedark-theme/tmux-onedark-theme.tmux'

# gruvbox
set -g @plugin 'egel/tmux-gruvbox'    # this is required
set -g @tmux-gruvbox 'dark'           # choose this line or next
# set -g @tmux-gruvbox 'light'

# -------------------------------------
# initialize tmux plugin manager
# (keep this line at the very bottom of tmux.conf)
# -------------------------------------

run '~/.tmux/plugins/tpm/tpm'
